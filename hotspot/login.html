<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Авторизация</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="author" content="Alexander A Kusakin <alexander.a.kusakin@gmail.com>">

    <link rel="stylesheet" href="./css/form.css">
    <link rel="stylesheet" href="./css/modal.css">

    <script src="./js/jquery-3.3.1.min.js"></script>
    <script src="./js/jquery.maskedinput.min.js"></script>
    <script type="text/javascript" src="/md5.js"></script>

    <script>

        function isValidPhoneNumber(phone) {
            var pattern = new RegExp(/^\s*(8|\+7)\s*-?\s*\(?[\d-]{3,6}\)?[\d-]{5,11}$/i
            );
            return pattern.test(phone);
        }
		
		var count=60;
		var counter=setInterval(timer, 1000); //1000 will  run it every 1 second
		
		function timer()
			{
			  if ($('#timer:visible').length == 0) return;

			  count=count-1;
			  if (count <= 0)
			  {
				 clearInterval(counter);
				 jQuery('#timer').hide();
				 jQuery('.code .btn.send_again').removeClass('disabled').addClass('active').show();
				 return;
			  }

			 document.getElementById("timer").innerHTML="Выслать повторно пароль<br>можно будет через "+ count + " сек."; // watch for spelling
			}

        jQuery(document).ready(function () {
			
			timer();
			
			jQuery('.code .btn.send_again').on('keyup', function (e) {
				jQuery('form.login').fadeIn();
            });
			
            jQuery('#login').mask('+9-(999)-999-99-99').on('keyup', function (e) {
                if (e.keyCode === 13) {
                    return jQuery('.login .btn.active').click();
                }

                if (isValidPhoneNumber(jQuery(this).val())) {
                    jQuery('.login .btn.next').removeClass('disabled').addClass('active');
                    jQuery('#login_form').attr('action', '$(link-login-only)#' + document.getElementById('login').value.replace(/[\-\(\)]/g, ''));
                    jQuery('#username1').val(document.getElementById('login').value.replace(/[\-\(\)]/g, ''));
                } else {
                    jQuery('.login .btn.next').removeClass('active').addClass('disabled');
                }

            });

            jQuery('#login2').mask('+9-(999)-999-99-99');

            jQuery('.already').on('keyup', '#login2', function (e) {

                if (e.keyCode === 13) {
                    return jQuery('.already .btn.active').click();
                }

                if (isValidPhoneNumber(jQuery(this).val())) {
                    jQuery('#username3').val(document.getElementById('login2').value.replace(/[\-\(\)]/g, ''));
                }

            }).on('keyup', '#code2', function (e) {

                if (event.keyCode === 13) {
                    return jQuery('.already .btn.active').click();
                }

                jQuery('#password2').val(hexMD5('$(chap-id)' + jQuery(this).val() + '$(chap-challenge)'));

            }).on('keyup', '#code2, #login2', function () {

                console.log(isValidPhoneNumber(jQuery('#login2').val()), jQuery('#password2').val().length >= 3)

                if (isValidPhoneNumber(jQuery('#login2').val()) && jQuery('#password2').val().length >= 3) {
                    jQuery('.already .btn').removeClass('disabled').addClass('active');
                } else {
                    jQuery('.already .btn').removeClass('active').addClass('disabled');
                }

            });

            jQuery('.btn').on('click', function (event) {

                if (jQuery(this).hasClass('disabled')) {
                    event.preventDefault();
                    event.stopPropagation();

                    return false;
                }

            });

            jQuery('#code').on('keyup', function (event) {

                if (event.keyCode === 13) {
                    return jQuery('.code .btn.active').click();
                }

                if (jQuery(this).val().length < 3) {
                    jQuery(this).addClass('disabled').removeClass('active');
					jQuery('#timer').show();
					timer();
                } else {
                    jQuery(".code .btn").addClass('active').removeClass('disabled');
                    jQuery('#password').val(hexMD5('$(chap-id)' + jQuery(this).val() + '$(chap-challenge)'));
					jQuery('#timer').hide();
					jQuery('.code .btn.send_again').removeClass('active').addClass('disabled').hide();
                }
            });

            jQuery('#has_code').on('click', function () {
				var login=$('#login').val();
				jQuery('#login2').val(login);
                jQuery('form.code, form.login').fadeOut(500, function () {
                    setTimeout(function () {
                        jQuery('form.already').fadeIn()
                    }, 500);
					//$('#login').val
					//$('#input').val("GeeksForGeeks"); 
                });
            });
			
			jQuery('#forgot_code').on('click', function () {
                jQuery('form.already').fadeOut(500, function () {
                    setTimeout(function () {
                        jQuery('form.login').fadeIn()
                    }, 500)
                });
            });

            if (!!window.location.hash) {
                jQuery('#username2').val(window.location.hash.replace('#', ''));
                jQuery('form.code').fadeIn();
            } else {
                jQuery('form.login').fadeIn();
            }

        });

    </script>
</head>
<body>
<div class="container">
    <div class="logo">
        <img src="./img/logo-ksc.png" alt="integrasky">
    </div>
    <!--<small class="form_description">Please log on to use the internet hotspot service</small>-->
    <form class="form login" id="login_form" style="display: none" method="get" name="sendin"
          action="$(link-login-only)" method="post">
		                <p class="info $(if error)alert$(endif)">
                        $(if error == "")<label>Пожалуйста, зарегистрируйтесь, чтобы<br>воспользоваться доступом в Интернет</label>$(if trial == 'yes')<br />Free trial available, <a href="$(link-login-only)?dst=$(link-orig-esc)&amp;username=T-$(mac-esc)">click here</a>.$(endif)
                        $(endif)

                        $(if error)<label style="color:red;">$(error)</label>$(endif)
                    </p>
        <label for="login">Введите Ваш номер телефона</label>
        <br>
        <div class="input_group tel">
            <img src="./img/number.svg" alt="number">
            <input type="hidden" name="username" id="username1">
            <input type="text" id="login" placeholder="+X-(XXX)-XXX-XX-XX">
			<input type="hidden" name="popup" value="true" />
        </div>
        <br>
        <button class="btn next disabled">
            Далее
        </button>
		<br>
				<a id="has_code" href="#">У меня уже есть пароль доступа</a>
    </form>

    <form class="form code" style="display: none" name="sendin" action="" method="post">
		<label for="instr">В течение минуты Вам придет<br>цифровой пароль с номера <strong>+79508935969</strong></label><br>
        <label for="code">Введите полученный пароль</label>
        <div class="input_group">
            <input type="hidden" name="username" id="username2">
            <input type="hidden" name="password" id="password">
            <input type="text" id="code" maxlength="8" placeholder="пароль">
			<input type="hidden" name="popup" value="true" />
        </div>
        <br>
		<small>Пароль станет недействителен, если не подключаться к сети в течение 3 дней.</small>
        <br>
		<br>
        <input type="submit" class="btn disabled" value="Далее">
		<br>
		<small id="timer"></small>
		<br>
		<input type="submit" name="send_again" class="btn send_again" style="display:none" value="Выслать пароль повторно">
    </form>

    <form class="form already" style="display: none" name="sendin" action="" method="post">
        <label for="login2">Введите Ваш номер телефона</label>
        <br>
        <div class="input_group tel">
            <input type="text" id="login2" placeholder="+X-(XXX)-XXX-XX-XX">
        </div>
        <label for="code">Введите пароль доступа</label>
        <br>
        <div class="input_group">
            <input type="hidden" name="username" id="username3">
            <input type="hidden" name="password" id="password2">
            <input type="text" id="code2" maxlength="8" placeholder="пароль">
			<input type="hidden" name="popup" value="true" />
        </div>
		<br>
        <input type="submit" class="btn disabled" value="Далее">
				<br>
				<a id="forgot_code" href="#">Я забыл пароль доступа</a>
    </form>
	<br>
    <label id="modal_trigger" for="modal-trigger">Авторизуясь, Вы принимаете Правила<br>доступа в сеть Интернет</label>
	<br>
	<div id="copyright"><small><a href="https://www.ksc.ru">©2020 ФИЦ КНЦ РАН Wi-Fi</a> | <a href="https://mikrotik.com/software">Powered by MikroTik RouterOS</a></small></div>
</div>
<div class="modal">
    <input id="modal-trigger" class="checkbox" type="checkbox">
    <div class="modal-overlay">
        <label for="modal-trigger" class="o-close"></label>
        <div class="modal-wrap">
		   <label for="modal-trigger" class="close">&#10006;</label>
            <h1 style="text-align: center;">П О Л О Ж Е Н И Е</h1>
<p style="text-align: center;"><strong>об использовании сети беспроводного доступа в Интернет ФИЦ КНЦ РАН</strong></p>
<p>&nbsp;</p>
<h1>&nbsp;1. Общие положения</h1>
<p>Положение об использовании сети беспроводного доступа в Интернет ФИЦ КНЦ РАН (далее - Положение) определяет порядок предоставления пользователям доступа к сети Интернет, идентификации пользователей и хранения данных сессий пользователей в соответствии с Постановлениями Правительства РФ №758 от 31 июля 2014 года и №801 от 12 августа 2014 года.</p>
<p>Право пользования Интернетом предоставляется пользователям за счет ФИЦ КНЦ РАН в целях обеспечения комфортной информационной среды для пребывания на его территории и на основании "Правил пользования доступом в сеть Интернет", накладывающих ограничения на пользователей по совершению действий, которые могут ограничить или ущемить свободы и права других пользователей сети Интернет.</p>
<p>В качестве средства идентификации пользователей ФИЦ КНЦ РАН использует их номера мобильных телефонов.</p>
<p>Беспроводный сегмент информационной вычислительной сети (далее ИВС) построен с использованием технологий стандартов 802.11 a/b/g/n/ac. Основой беспроводной сети являются точки доступа (далее ТД), подключенные посредством проводной технологии Ethernet к коммутационному оборудованию ИВС ФИЦ КНЦ РАН. Зона покрытия каждой ТД определяется поглощающими свойствами стен и перекрытий зданий, и, как правило, не превышает расстояния 30 метров от ТД. Схема размещения ТД представлена в Приложении №1. Идентификатор беспроводной сети (SSID) ФИЦ КНЦ РАН единый на всех объектах &laquo;KSC-RAS-guest&raquo;.</p>
<p>Сеть не имеет защиты и шифрования средствами протоколов беспроводной связи, т.е. является открытой. Авторизация и защита организована средствами протоколов и интерфейсов более высоких уровней. Подключение устройств к беспроводной сети осуществляется в соответствии с настоящим Положением.</p>
<p>Подключенные и авторизованные устройства получают доступ только в сеть Интернет, но не в локальную ИВС ФИЦ КНЦ РАН, за исключением страницы статистики и управлениями сессиями (см. п.4.4 настоящего Положения).</p>
<p>Максимальная скорость доступа в сеть Интернет ограничивается значением 20 Мбит/с в обе стороны на подключение в случае работы ИВС ФИЦ КНЦ РАН в штатном режиме по основному каналу связи и 15 Мбит/с в обе стороны на подключение в случае работы по резервному каналу связи. В случае приема или отдачи больших файлов максимальная скорость ограничивается до 5 Мбит/с в обе стороны на подключение независимо от действующего канала связи ИВС ФИЦ КНЦ РАН.</p>
<p><strong>&nbsp;</strong></p>
<h1>&nbsp;2. Основные понятия и сокращения</h1>
<p>В настоящем Положении применяются следующие основные понятия и сокращения:</p>
<ul>
<li>пользователь - любое лицо, находящееся в зоне покрытия беспроводной сетью ФИЦ КНЦ РАН и имеющее техническую возможность к ней подключаться.</li>
<li>услуга - доступ в Интернет, а именно физические, организационные, программные, правовые меры обеспечения доступа в Интернет с использованием возможностей ФИЦ КНЦ РАН.</li>
<li>идентификация &ndash; процедура подтверждения пользователя по его номеру мобильного телефона</li>
<li>сессия пользователя &ndash; промежуток времени между авторизованным входом в систему учета пользователей с предоставлением доступа к Интернету и выходом из системы с записью временных меток ее начала и конца</li>
</ul>
<p>Ответственность за доступ включает в себя:</p>
<ul>
<li>аспекты безопасности (физические и логические);</li>
<li>гарантии того, что обеспечение доступа в Интернет не ставит под угрозу целостность ресурсов ФИЦ КНЦ РАН.</li>
</ul>
<p>Иные термины и определения применяются в смысле последней редакции ГОСТ 34.003-90. Информационная технология. Комплекс стандартов на автоматизированные системы. Автоматизированные системы. Термины и определения, утвержденного Постановлением Госстандарта СССР от 27.12.1990 N 3399.</p>
<p>&nbsp;</p>
<h1>&nbsp;3. Обеспечение доступа в Интернет</h1>
<p>3.1. Организационное и техническое обеспечение процессов предоставления доступа к сети Интернет, идентификации и хранения данных сессий пользователей, содержащих механизмы подтверждения подлинности пользователей по учетным записям и значениям паролей, возлагается на сотрудников научно-организационного отдела (НОО) ФИЦ КНЦ РАН.</p>
<p>3.2. С целью соблюдения принципа персональной ответственности за свои действия каждому пользователю, прошедшему процедуру авторизации, предоставляется персональное уникальное имя - учетная запись пользователя (далее логин) в виде его номера телефона и пароль, по которым он будет регистрироваться и работать в сети Интернет.</p>
<p>3.3. Каждому логину разрешено создавать максимум 2 одновременных сессии на случай подключения 2 устройств, одно из которых не имеет возможности проходить идентификацию по номеру телефона (например, планшет без встроенного GSM модема).</p>
<p>3.4. Данные начала и окончания сессии каждого пользователя хранятся НОО в течение 6 месяцев.</p>
<p>&nbsp;</p>
<h1>&nbsp;4. Процедуры подключения и отключения пользователей</h1>
<p>4.1. При подключении к ТД в первый раз система выведет интерфейс ввода номера телефона пользователя, который будет использоваться в качестве логина для открытия и закрытия сессии, а также для получения кода доступа (пароля) в СМС сообщении.</p>
<p>4.2. Передавая данные о своем номере телефона пользователь соглашается с &laquo;Правилами доступа в сеть Интернет&raquo;, изложенными в п.5 настоящего Положения. С текстом Положения пользователь может ознакомиться, нажав соответствующую ссылку в интерфейсе авторизации.</p>
<p>4.2. После нажатия &laquo;Далее&raquo; в течение одной минуты с номера +79xx-xxx-xx-xx придет СМС сообщение, содержащее цифровой код доступа, который нужно будет ввести в интерфейсе подключения.</p>
<p>4.3. Срок действия выданного кода для подключения без запроса на его ввод три дня. Если в течение трех дней подключений с авторизованного устройства не было, то при следующем подключении необходимо будет либо сделать запрос на получение нового кода, путем ввода номера телефона, как в п. 4.1, либо, если последний код доступа не утерян, нажать &laquo;У меня уже есть код доступа&raquo; и ввести свой номер телефона и этот код.</p>
<p>4.4. После успешного входа на устройстве появится доступ в сеть Интернет и будет осуществлен автоматический переход на страницу статистики сессии. На этой странице можно посмотреть статистику входящего исходящего трафика, а также закрыть текую сессию. В дальнейшем перейти на эту страницу можно после подключения к ТД, введя в интернет браузере адрес <a href="http://stats.ksc.loc/status">http://stats.ksc.loc/status</a></p>
<p>4.5. Если количество действующих сессий на логин превысило две (например, логин и код доступа пользователя были скомпрометированы), то при попытке подключится к ТД с номера +79xx-xxx-xx-xx придет СМС сообщение с инструкцией по дальнейшим действиям.</p>
<p>4.6. В целях безопасности длительность одной сессии равна 30 минутам, также при отсутствии любой сетевой активности сессия автоматически закроется через 1 минуту. В случаях закрытия сессии при подключении к ТД будет автоматически открыт интерфейс возобновления сессии, вводить код не потребуется, если, согласно п. 4.3, последнее подключение было не более трех дней назад.</p>
<p><strong>&nbsp;</strong></p>
<h1>&nbsp;5. Правила пользования доступом в сеть Интернет</h1>
<p>5.1. При пользовании Услугами запрещается:</p>
<p>5.1.1. Ограничивать доступ других Пользователей или препятствовать другим Пользователям в использовании Услуг.</p>
<p>5.1.2. Посылать рекламные, информационные и другие материалы без согласия (или при отсутствии заявки) со стороны адресатов, а также в несоответствующие по тематике электронные издания и конференции.</p>
<p>5.1.3. Производить "веерную" (массовую) рассылку рекламных, информационных и других материалов другим пользователям сети интернет, кроме случаев, когда адресаты согласны получить эти материалы, как на адрес персональной электронной почты, так и через электронные издания и конференции общего доступа, для этого не предназначенные.</p>
<p>Примечание. Под "веерной" (массовой) рассылкой понимается отправка одновременно по двум и более адресам сообщений, на получение которых у Пользователя не имеется согласия владельцев этих адресов. Настоящее ограничение никоим образом не имеет отношения к системе электронной подписки.</p>
<p>5.1.4. Производить самовольное (несанкционированное) проникновение в любые технологические компоненты (узлы), программы, базы данных и иные составляющие элементы ИВС ФИЦ КНЦ РАН, интернет, имея в виду действия, совершение или покушение на совершение которых предусматривает установленную в РФ уголовную ответственность за такие деяния, как гл. 21 УК РФ "Преступления против собственности" ст. 159 "Мошенничество"; гл. 28 УК РФ "Преступления в сфере компьютерной информации": ст. 272 "Неправомерный доступ к компьютерной информации", ст. 273 "Создание, использование и распространение вредоносных программ для ЭВМ", ст. 274 "Нарушение правил эксплуатации ЭВМ, системы ЭВМ или их сети".</p>
<p>5.1.5. Посылать или делать доступной по сети интернет любую информацию, распространение которой, так или иначе, противоречит российскому или международному праву.</p>
<p>5.1.6. Передавать любую информацию или программное обеспечение, которое содержит в себе вирусы или другие вредные компоненты.</p>
<p>5.1.7. Посылать, передавать, воспроизводить, предоставлять или в любом виде использовать в коммерческих целях информацию, программное обеспечение, или другие материалы, полностью или частично, полученные посредством Услуг (если это явно не разрешено поставщиком подобной информации, программного обеспечения или другой продукции).</p>
<p>5.1.8. Посылать, передавать, воспроизводить или распространять любым способом полученные посредством Услуг программное обеспечение или другие материалы, полностью или частично, защищенные авторскими или другими правами, без разрешения владельца или законного правообладателя; посылать, передавать или распространять любым способом любую составляющую предоставляемой Услуг или созданные на их основе работы, так как сами Услуги также являются объектом авторских и других прав.</p>
<p>5.1.9. Нарушать правила использования любых ресурсов сети интернет, установленные ФИЦ КНЦ РАН и/или владельцами этих ресурсов.</p>
<p>5.1.10. Использовать программное обеспечение, производящее автоматическую авторизацию Пользователя в целях получения Услуги, за исключением программного обеспечения, предоставленного либо одобренного ФИЦ КНЦ РАН.</p>
<p>5.1.11. В соответствии с требованиями действующего законодательства Пользователем, принимая условия настоящего Соглашения выражает предварительное согласие на получение рекламы в любой форме и в любом виде в рамках пользования Услуг.</p>
<p>5.1.12. Если Пользователь не согласен с правилами использования какого-либо ресурса, он должен немедленно отказаться от его использования.</p>
<p>5.2. ФИЦ КНЦ РАН не будет преднамеренно просматривать или разглашать любые частные сообщения электронной почты (за исключением случаев, предусмотренных законом).</p>
<p>5.3. ФИЦ КНЦ РАН не обязан следить за содержанием информации, распространяемой посредством Услуг. Однако Пользователь принимает условие, что ФИЦ КНЦ РАН имеет право периодически отслеживать проходящую через Услуги информацию и раскрывать любые сведения, если это необходимо в соответствии с законом, требованиями уполномоченных государственных учреждений, либо для нормального функционирования Услуг, либо для защиты ФИЦ КНЦ РАН, иных Пользователей, а равно третьих лиц, чьи законные права и интересы были или могут быть нарушены.</p>
<p>5.4. ФИЦ КНЦ РАН оставляет за собой право отказать в пересылке или удалять со своих серверов любую информацию или материалы полностью или частично, если они, исключительно с точки зрения ФИЦ КНЦ РАН, являются неприемлемыми, нежелательными или нарушают настоящее Положение.</p>
        </div>
    </div>
</div
</body>
</html>